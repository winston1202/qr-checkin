
{% extends "admin_layout.html" %}

{% block title %}Application Settings{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-md max-w-2xl">
    <h2 class="text-2xl font-semibold mb-6 border-b pb-3">Feature Management</h2>

    <form action="{{ url_for('update_settings') }}" method="POST">
        <input type="hidden" name="setting_name" value="LocationVerificationEnabled">

        <div class="flex items-center justify-between p-4 rounded-lg hover:bg-gray-50">
            <div>
                <h3 class="font-medium text-gray-800">Location Verification</h3>
                <p class="text-sm text-gray-500">
                    If enabled, users must be within the geofence to clock in/out.
                </p>
            </div>
            
            <label for="location-toggle" class="flex items-center cursor-pointer">
                <div class="relative">
                    
                    <!-- 
                      ===============================================================
                      == THIS IS THE FIX FOR THE RED TEXT ===========================
                      ===============================================================
                      1. We set a variable 'is_checked' BEFORE the <input> tag.
                      2. We simply print the 'is_checked' variable inside the tag.
                      This separates the logic from the HTML, which makes the syntax
                      highlighter happy and removes the red highlighting.
                    -->
                    {% set is_checked = 'checked' if settings.get('LocationVerificationEnabled') == 'TRUE' else '' %}
                    
                    <input type="checkbox" id="location-toggle" name="setting_value" class="sr-only" 
                           onchange="this.form.submit()" 
                           {{ is_checked }}>
                    
                    <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                    <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
                </div>
            </label>
        </div>
    </form>
    
</div>

<style>
    /* Simple CSS for the toggle switch */
    input:checked ~ .dot {
        transform: translateX(100%);
        background-color: #f7fafc;
    }
    input:checked ~ .block {
        background-color: #48bb78; /* green */
    }
</style>
{% endblock %}